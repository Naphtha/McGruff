<!DOCTYPE html>
<meta charset="utf-8">

<!-- Authored by Shawn Shojaie :) -->

<style>
.chart rect {
  fill: steelblue;
}

.chart text {
  fill: black;
  font: 10px sans-serif;
  text-anchor: end;
}
</style>

<svg class="chart"></svg>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://code.jquery.com/jquery-1.11.2.min.js" charset="utf-8"></script>



<script>

var width = 300;
var barHeight = 15;

// scale the graph
var x = d3.time.scale().range([0,width]);
  
// select chart div
var chart = d3.select(".chart").attr("width", width);

// set up date/time format specifier for d3 processing
var format = d3.time.format("%H:%M");


// load from file
d3.json("log.json", function(jsonfile){
//console.log(data);

var data = new Array();

// for each data in the log file
for( i in jsonfile ){

  data = data.concat(jsonfile[i][0]);

}


//data = JSON.parse( data );

x.domain([d3.min(data, function(d){ return format.parse(d.time); }), d3.max(data, function(d){ return format.parse(d.time); })]);

chart.attr("height", barHeight * data.length);

var bar = chart.selectAll("g").data(data).enter().append("g").attr("transform", function(d,i){ return "translate(0," + i * barHeight + ")";});

bar.append("rect").attr("width", function(d){ return x(format.parse(d.time)); }).attr("height", barHeight - 1);

bar.append("text").attr("x", width)
  .attr("y", barHeight - 5)
  .attr("dy", ".35em")
  .text(function(d){ return d.activity });

});

function type(d){
  d.value = +d.value;
  return d;
}


</script>

<div>
  This chart displays a bar with a height corresponding to the time of day the crime was reported. The labels are the type of crime committed.
</div>




